import re

def filter_fasta_by_chain_id(chain_ids, fasta_file, output_file):
    with open(fasta_file, 'r', encoding='utf-8') as f:
        lines = f.readlines()
    selected_lines = []
    save_sequence = False   
    for line in lines:
        if line.startswith('>'):
            match = re.search(r'Chain ([A-Za-z0-9]+)', line)
            if match:
                chain_id = match.group(1)
                save_sequence = chain_id in chain_ids
            else:
                save_sequence = False       
        if save_sequence:
            selected_lines.append(line)    
    with open(output_file, 'w', encoding='utf-8') as out_f:
        out_f.writelines(selected_lines)
    print(f"File filtrato salvato in: {output_file}")
